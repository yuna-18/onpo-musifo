import{r as t,U as c,j as s,L as W,$ as q}from"./app-DiDAcyJ-.js";import{H as J}from"./Header-D3HYzLkg.js";import{S as K}from"./Stack-B7pYcO5u.js";import{c as Q,V as w,n as Y,o as Z,B as z}from"./Button-DXrz27hV.js";import{u as ee}from"./useDecorators-8LPYdjlv.js";import"./styled-components.browser.esm-BWa_pBDO.js";import"./index-BmlcJqsV.js";const D=(a,e)=>{let n=null;return function(...i){n!==null&&clearTimeout(n),n=setTimeout(()=>{a(...i)},e)}},y=a=>{const e=typeof a=="number"||typeof a=="string"?`${a}`:Array.isArray(a)?a.join(","):"",n=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;return e.length-(e.match(n)||[]).length},te={beforeMaxLettersCount:"あと",afterMaxLettersCount:"文字",afterMaxLettersCountExceeded:"オーバー",beforeScreenReaderMaxLettersDescription:"最大",afterScreenReaderMaxLettersDescription:"文字入力できます"},re=Q({slots:{textareaEl:["smarthr-ui-Textarea-textarea","shr-border-shorthand shr-my-[unset] shr-box-border shr-rounded-m shr-bg-white shr-p-0.5 shr-text-base shr-leading-normal shr-text-black shr-opacity-100","contrast-more:shr-border-high-contrast","placeholder:shr-text-grey","focus-visible:shr-focus-indicator","disabled:shr-pointer-events-none disabled:shr-bg-column disabled:shr-text-disabled disabled:placeholder:shr-text-disabled","aria-[invalid]:shr-border-danger"],counter:"smarthr-ui-Textarea-counter shr-block shr-text-sm",counterText:"shr-text-black"},variants:{error:{true:{counterText:"shr-text-danger"}}},defaultVariants:{error:!1}}),I=(a,e=Number.MAX_SAFE_INTEGER)=>{if(!a)return 0;const n=Math.floor(a.scrollHeight/(Y*Number(Z.normal)));return n<e?n:e},ae=t.forwardRef(({autoFocus:a,maxLetters:e,width:n,className:i,autoResize:d=!1,maxRows:f=1/0,rows:b=2,onInput:h,decorators:R,error:E,onChange:m,...g},F)=>{const M=t.useId(),S=`${M}-notice`,T=e?M:void 0,u=t.useRef(null),j=g.defaultValue||g.value,[U,C]=t.useState(b),[x,B]=t.useState(j?y(j):0),[$,H]=t.useState(""),l=ee(te,R),p=t.useCallback(r=>{if(e!==void 0)return r>e?c.createElement(c.Fragment,null,r-e,l.afterMaxLettersCount,l.afterMaxLettersCountExceeded):c.createElement(c.Fragment,null,l.beforeMaxLettersCount,e-r,l.afterMaxLettersCount)},[e,l.afterMaxLettersCountExceeded,l.afterMaxLettersCount,l.beforeMaxLettersCount]),V=t.useMemo(()=>p(x),[x,p]);t.useImperativeHandle(F,()=>u.current);const k=t.useCallback(D(r=>{t.startTransition(()=>{B(y(r))})},200),[]),v=t.useCallback(D(r=>{t.startTransition(()=>{const o=p(y(r));o&&H(o)})},1e3),[p]),A=t.useCallback(r=>{if(e){const o=r.currentTarget.value;k(o),v(o)}m==null||m(r)},[k,e,m,v]);t.useEffect(()=>{a&&u&&u.current&&u.current.focus()},[a]),t.useEffect(()=>{d&&u.current&&C(I(u.current,f))},[C,f,d]);const L=t.useCallback(r=>{if(r.target.rows=b,d){const o=I(r.target,f);r.target.rows=o,C(o)}h==null||h(r)},[d,f,h,b]),{textareaStyleProps:_,counterStyle:O,counterTextStyle:P}=t.useMemo(()=>{const{textareaEl:r,counter:o,counterText:X}=re();return{textareaStyleProps:{className:r({className:i}),style:{width:typeof n=="number"?`${n}px`:n}},counterStyle:o(),counterTextStyle:X({error:!!(e&&e-x<0)})}},[i,x,e,n]),G=t.useMemo(()=>{const r=e&&x>e;return E||r||void 0},[E,e,x]),N=c.createElement("textarea",{...g,..._,...e&&{"aria-describedby":`${S} ${T}`},"data-smarthr-ui-input":"true",onChange:A,ref:u,"aria-invalid":G||void 0,rows:U,onInput:L});return e?c.createElement("span",null,N,c.createElement("span",{className:O},c.createElement("span",{className:P,id:T,"aria-hidden":!0},V)),c.createElement(w,{"aria-live":"polite"},$),c.createElement(w,{id:S},l.beforeScreenReaderMaxLettersDescription,e,l.afterScreenReaderMaxLettersDescription)):N}),se=()=>{const[a,e]=t.useState(!1),i=`javascript:(function(){
    const url = encodeURIComponent(window.location.href);
    const title = encodeURIComponent(document.title);
    const popupUrl = "http://localhost/favorite/create?title=" + title + "&url=" + url;
    window.open(popupUrl, "BookmarkWindow", "width=600,height=500");
  })();`,d=async()=>{try{await navigator.clipboard.writeText(i),e(!0),setTimeout(()=>e(!1),2e3)}catch{alert("コピーに失敗しました")}};return s.jsxs(K,{className:"gap-y-4 max-w-3xl",children:[s.jsxs("ol",{className:"list-decimal pl-6 text-sm leading-relaxed",children:[s.jsxs("li",{children:["以下のコードをコピーして、ブラウザのブックマークバーに貼り付けてください。",s.jsx("br",{}),"通常のブックマークと同様に名前をつけることもできます。(例：お気に入り追加)"]}),s.jsx("li",{children:"クリックすると、開いているページがブックマークとして登録されます。"})]}),s.jsx(ae,{readOnly:!0,value:i,rows:6,className:"font-mono text-xs"}),s.jsx(z,{onClick:d,variant:"primary",className:"h-[44px]",children:a?"コピーしました！":"コードをコピー"})]})},xe=({authUser:a})=>s.jsxs(s.Fragment,{children:[s.jsx(W,{title:"音すくい | お気に入り追加方法"}),s.jsx(J,{authUser:a}),s.jsxs("main",{className:"pt-[148px] px-4 md:px-8 text-[var(--color-text-primary)] max-w-3xl mx-auto",children:[s.jsx("h2",{className:"font-bold text-3xl text-center mb-8",children:"お気に入り登録用ブックマークレット"}),s.jsx(se,{}),s.jsx("div",{className:"mt-12 text-center",children:s.jsx(q,{href:"/favorite",className:"text-base font-bold underline text-[var(--color-text)] hover:opacity-80",children:"お気に入り一覧に戻る"})})]})]});export{xe as default};
