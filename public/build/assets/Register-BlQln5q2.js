import{r as s,U as o,m as et,j as f,L as tt}from"./app-Cnv_U2qP.js";import"./index-DsNvFgoG.js";import{H as st}from"./Header-B5ESEpJx.js";import{c as rt,T as nt}from"./ThemeProvider-UJxkIBf0.js";import{S as Me}from"./Stack-d_dt5XnX.js";import{A as at,T as ot,g as lt,F as re,I as ce,C as ue}from"./Input-Czq5P8v9.js";import{F as it,a as ct,b as ut,c as J,d as ht,e as dt,i as ae,u as pt,s as mt,V as ft,T as bt,t as he,f as xt}from"./DisabledDetail-DIM80HJJ.js";import{u as gt,L as yt,B as vt}from"./styled-components.browser.esm-DIebLmgc.js";import{F as wt}from"./AnchorButton-BFW67PZi.js";import"./index-DAk3zxFP.js";const _t=it,Ct=ut,kt=ct,Et=J({slots:{wrapper:"smarthr-ui-CheckBox shr-inline-flex shr-items-baseline",box:["shr-border-shorthand shr-pointer-events-none shr-absolute shr-box-border shr-h-full shr-w-full shr-rounded-s shr-bg-white","contrast-more:shr-border-high-contrast","forced-colors:shr-hidden","peer-checked:shr-border-main peer-checked:shr-bg-main contrast-more:peer-checked:shr-border-high-contrast","peer-indeterminate:shr-border-main peer-indeterminate:shr-bg-main contrast-more:peer-indeterminate:shr-border-high-contrast","peer-disabled:shr-border-disabled peer-disabled:shr-bg-white-darken","peer-disabled:peer-checked:shr-border-default peer-disabled:peer-checked:shr-bg-border","peer-disabled:peer-indeterminate:shr-border-default peer-disabled:peer-indeterminate:shr-bg-border","peer-focus-visible:shr-focus-indicator","peer-hover:shr-shadow-input-hover","shr-border-default","peer-[[aria-invalid]]:shr-border-danger"],input:["smarthr-ui-CheckBox-checkBox shr-peer shr-absolute shr-left-0 shr-top-0 shr-m-0 shr-h-full shr-w-full shr-cursor-pointer shr-opacity-0 disabled:shr-pointer-events-none","forced-colors:shr-static forced-colors:shr-opacity-100"],icon:"shr-fill-current",iconWrap:["shr-pointer-events-none shr-absolute shr-left-1/2 shr-top-1/2 shr-inline-block shr-h-[theme(fontSize.2xs)] shr-w-[theme(fontSize.2xs)] -shr-translate-x-1/2 -shr-translate-y-1/2 shr-text-2xs","shr-text-transparent peer-checked:shr-text-white peer-indeterminate:shr-text-white","peer-disabled:peer-indeterminate:shr-text-white-darken peer-disabled:peer-checked:shr-text-white-darken","forced-colors:shr-hidden"],innerWrapper:"shr-relative shr-box-border shr-inline-block shr-h-[theme(fontSize.base)] shr-w-[theme(fontSize.base)] shr-shrink-0 shr-translate-y-[0.125em] shr-leading-none",label:["smarthr-ui-CheckBox-label shr-ms-0.5 shr-cursor-pointer shr-text-base shr-leading-tight","[[data-disabled=true]>&]:shr-pointer-events-none [[data-disabled=true]>&]:shr-cursor-not-allowed [[data-disabled=true]>&]:shr-text-disabled"]}}),ne=s.forwardRef(({checked:t,mixed:e,error:n,className:a,children:h,disabled:p,...g},b)=>{const y=s.useMemo(()=>{const{wrapper:x,innerWrapper:F,box:L,input:v,iconWrap:E,icon:T,label:B}=Et();return{wrapper:x({className:a}),innerWrapper:F(),box:L(),input:v(),iconWrap:E(),icon:T(),label:B()}},[a]),c=s.useRef(null);s.useImperativeHandle(b,()=>c.current),s.useEffect(()=>{c.current&&(c.current.indeterminate=!!(t&&e))},[t,e]);const _=s.useId(),i=g.id||_;return o.createElement("span",{"data-disabled":p,className:y.wrapper},o.createElement("span",{className:y.innerWrapper},o.createElement("input",{...g,ref:c,type:"checkbox",id:i,checked:t,disabled:p,"aria-invalid":n||void 0,className:y.input,"data-smarthr-ui-input":"true"}),o.createElement(Mt,{className:y.box}),o.createElement(It,{mixed:e,className:y.iconWrap,iconClassName:y.icon})),o.createElement(St,{htmlFor:i,className:y.label},h))}),Mt=o.memo(({className:t})=>o.createElement("span",{className:t,"aria-hidden":"true"})),It=o.memo(({mixed:t,className:e,iconClassName:n})=>o.createElement("span",{className:e},t?o.createElement(ht,{className:n}):o.createElement(dt,{className:n}))),St=o.memo(({children:t,htmlFor:e,className:n})=>t&&o.createElement("label",{htmlFor:e,className:n},t)),Bt=J({base:["smarthr-ui-Chip","shr-border-shorthand shr-rounded-full shr-bg-white shr-text-black shr-leading-none","contrast-more:shr-border-high-contrast"],variants:{size:{s:"shr-text-sm shr-px-0.5 shr-py-0.25"},disabled:{true:"shr-bg-white/50 shr-text-disabled"}},defaultVariants:{size:"s"}}),Nt=({size:t,disabled:e,className:n,...a})=>{const h=s.useMemo(()=>Bt({size:t,disabled:e,className:n}),[t,e,n]);return o.createElement("span",{...a,className:h})},Lt=J({base:["shr-box-content shr-inline shr-cursor-pointer shr-select-auto shr-appearance-none shr-items-stretch shr-overflow-visible shr-border-none shr-border-current shr-bg-transparent shr-bg-none shr-bg-origin-padding shr-p-0 shr-text-left shr-font-inherit shr-text-inherit shr-text-color-inherit","focus-visible:shr-focus-indicator"]}),Tt=s.forwardRef(({className:t,type:e="button",...n},a)=>{const h=s.useMemo(()=>Lt({className:t}),[t]);return o.createElement("button",{...n,type:e,ref:a,className:h})}),te=t=>o.createElement(at,{...t,as:"fieldset"}),Pt=(t,e)=>s.useMemo(()=>{var a;if(!e)return t;const n={};for(const h in t){const p=t[h];n[h]=((a=e[h])==null?void 0:a.call(e,p))||p}return n},[e,t]);function Rt(t,e){const n=s.useCallback(a=>{t.some(h=>At(a,h.current))||e(a)},[...t,e]);s.useEffect(()=>(window.addEventListener("click",n),()=>{window.removeEventListener("click",n)}),[n])}function At(t,e){const n=t.composedPath();return n.length===0||!e?!1:n.includes(e)}function Ie(t){return t.replace(/\s/g," ").replace(/’/g,"'").replace(/[”“]/g,'"').replace(/｀/g,"`").replace(/￥/g,"¥").replace(/−/g,"-").replace(/〜/g,"~").replace(/[！-｝]/g,e=>String.fromCharCode(e.charCodeAt(0)-65248)).toLowerCase()}function de(t,e){return t.value===e.value&&ae(t.label)===ae(e.label)}function jt(t){const e=s.useMemo(()=>Array.from({length:t}).map(()=>s.createRef()),[t]),n=s.useRef(null),[a,h]=s.useState(null),p=s.useCallback(()=>{var y,c,_;if(t!==0)if(a===null){if(((y=n.current)==null?void 0:y.selectionStart)===0){const i=e.length-1;(c=e[i].current)==null||c.focus(),h(i)}}else{const i=Math.max(a-1,0);(_=e[i].current)==null||_.focus(),h(i)}},[e,a,t]),g=s.useCallback(()=>{var y;if(e.length!==0&&a!==null){const c=a+1;c<e.length?((y=e[c].current)==null||y.focus(),h(c)):(h(null),setTimeout(()=>{var _;(_=n.current)==null||_.focus()}))}},[e,a]),b=s.useCallback(()=>{h(null)},[]);return{deletionButtonRefs:e,inputRef:n,focusPrevDeletionButton:p,focusNextDeletionButton:g,resetDeletionButtonFocus:b}}const Te=J({base:["shr-block shr-min-w-full shr-cursor-pointer shr-border-none shr-px-1 shr-py-0.5 shr-text-left shr-text-base shr-leading-tight","aria-selected:shr-text-white","disabled:shr-cursor-not-allowed disabled:shr-text-disabled","data-[active=true]:shr-bg-white-darken data-[active=true]:aria-selected:shr-bg-main-darken","data-[active=false]:shr-bg-white data-[active=false]:aria-selected:shr-bg-main"],variants:{new:{true:"smarthr-ui-ComboBox-addButton shr-flex shr-items-center",false:"smarthr-ui-ComboBox-selectButton"}}}),Ot=({option:t,onAdd:e,onSelect:n,onMouseOver:a,activeRef:h})=>{const p=s.useCallback(()=>{a(t)},[a,t]),g={option:t,onMouseOver:p,activeRef:h};return t.isNew?o.createElement($t,{...g,onAdd:e}):o.createElement(Ut,{...g,onSelect:n})},Ft=o.memo,Wt=Ft(Ot),$t=({activeRef:t,option:e,onAdd:n,onMouseOver:a})=>{const h=s.useMemo(()=>Te({new:!0}),[]),p=s.useMemo(()=>n?()=>{n(e)}:void 0,[e,n]);return o.createElement("button",{ref:t,type:"button",role:"option","aria-selected":!1,id:e.id,"data-active":!!t,onClick:p,onMouseOver:a,className:h},o.createElement(Ct,{color:"TEXT_LINK",text:o.createElement(ot,{color:"TEXT_LINK"},"「",e.item.label,"」を追加")}))},Ut=({activeRef:t,option:e,onSelect:n,onMouseOver:a})=>{const h=s.useMemo(()=>Te({new:!1}),[]),p=s.useCallback(()=>{n(e)},[n,e]);return o.createElement("button",{ref:t,type:"button",role:"option",id:e.id,disabled:e.item.disabled,"aria-selected":e.selected,"data-active":!!t,onClick:p,onMouseOver:a,className:h},e.item.label)};function Dt({options:t}){const[e,n]=s.useState(null);s.useEffect(()=>{n(g=>g===null?null:t.find(b=>g.id===b.id)??null)},[t]);const a=s.useCallback((g,b)=>{if(t.every(i=>i.item.disabled))return;const y=g===null?-1:t.findIndex(i=>i.id===g.id),c=y===-1?b===1?0:t.length-1:(y+b+t.length)%t.length,_=t[c];_&&(_.item.disabled?a(_,b):n(_))},[t]),h=s.useCallback(()=>{a(e,1)},[e,a]),p=s.useCallback(()=>{a(e,-1)},[e,a]);return{activeOption:e,setActiveOption:n,moveActivePositionDown:h,moveActivePositionUp:p}}const Se=100,Kt=()=>null;function zt({items:t,minLength:e=0}){const n=s.useCallback(b=>Math.max(b,e),[e]),[a,h]=s.useState(n(Se));s.useEffect(()=>{h(b=>n(b))},[n]);const p=s.useMemo(()=>t.slice(0,a),[a,t]),g=s.useCallback(()=>o.createElement(Ht,{onIntersect:()=>{h(b=>n(b+Se))}}),[n]);return{items:p,renderIntersection:a>=t.length?Kt:g}}const Ht=({onIntersect:t})=>{const e=s.useRef(null);return s.useEffect(()=>{const n=e.current;if(n===null)return;const a=new IntersectionObserver(([h])=>{h.isIntersecting&&t()});return a.observe(n),()=>a.disconnect()},[t]),o.createElement("div",{ref:e})},Xt={noResultText:"一致する選択肢がありません",loadingText:"処理中"},qt=/^(Arrow)?Down$/,Yt=/^(Arrow)?Up/,Gt=J({slots:{wrapper:"shr-absolute",dropdownList:["smarthr-ui-ComboBox-dropdownList","shr-absolute shr-z-overlap shr-box-border shr-min-w-full shr-overflow-y-auto shr-rounded-m shr-bg-white shr-py-0.5 shr-shadow-layer-3","shr-max-h-[calc((theme(fontSize.base)_+_theme(spacing[0.5])_*_2)_*_7.5_+_theme(spacing[0.5]))]","aria-hidden:shr-hidden"],helpMessage:"shr-whitespace-[initial] shr-border-b-shorthand shr-mx-0.5 shr-mb-0.5 shr-mt-0 shr-px-0.5 shr-pb-0.5 shr-pt-0 shr-text-sm",loaderWrapper:"shr-flex shr-items-center shr-justify-center shr-p-1",noItems:"smarthr-ui-ComboBox-noItems shr-my-0 shr-bg-white shr-px-1 shr-py-0.5 shr-text-base"}}),Jt=({options:t,dropdownHelpMessage:e,dropdownWidth:n,onAdd:a,onSelect:h,isExpanded:p,isLoading:g,triggerRef:b,decorators:y})=>{const[c,_]=s.useState("pointer"),{activeOption:i,setActiveOption:x,moveActivePositionDown:F,moveActivePositionUp:L}=Dt({options:t});s.useEffect(()=>{p||x(null)},[p,x]);const v=s.useRef(null),[E,T]=s.useState({top:0,left:0}),[B,P]=s.useState(0);s.useEffect(()=>{if(!b.current)return;const d=b.current.getBoundingClientRect();P(d.width)},[p,b]);const C=s.useCallback(()=>{if(!v.current||!b.current)return;const d=b.current.getBoundingClientRect(),k=window.innerHeight-d.bottom,I=d.top,r=Math.min(v.current.scrollHeight,parseInt(getComputedStyle(v.current).maxHeight,10)),u=2;let m=0,M;k>=r?m=d.top+d.height-u+window.pageYOffset:I>=r?m=d.top-r+u+window.pageYOffset:I>k?(m=d.top-I+u+window.pageYOffset,M=I):(m=d.top+d.height-u+window.pageYOffset,M=k),T({top:m,left:d.left+window.pageXOffset,height:M}),P(d.width)},[v,b]),R=s.useRef(null);s.useEffect(()=>{if(!R.current||!v.current||i===null||c!=="key")return;const d=R.current.getBoundingClientRect(),k=v.current.getBoundingClientRect();d.top<k.top?v.current.scrollTop-=k.top-d.top:d.bottom>k.bottom&&(v.current.scrollTop+=d.bottom-k.bottom)},[i,v,c]),pt(()=>{p&&C()},[C,p,t]);const W=s.useCallback(d=>{if(_("key"),qt.test(d.key))d.stopPropagation(),F();else if(Yt.test(d.key))d.stopPropagation(),L();else if(d.key==="Enter"){if(i===null)return;d.stopPropagation(),i.isNew?a&&a(i.item.value):h(i.item)}else x(null)},[i,F,L,a,h,x]),{createPortal:$}=gt(),A=s.useId(),{items:N,renderIntersection:q}=zt({items:t,minLength:s.useMemo(()=>(i===null?0:t.indexOf(i))+1,[i,t])}),X=s.useMemo(()=>a?d=>{requestAnimationFrame(()=>{a(d.item.value)})}:void 0,[a]),Y=s.useCallback(d=>{h(d.item)},[h]),G=s.useCallback(d=>{_("pointer"),x(d)},[x]),U=s.useMemo(()=>{const{top:d,left:k}=E;return{top:`${d}px`,left:`${k}px`,width:`${B}px`}},[E,B]),w=s.useMemo(()=>{const{left:d,height:k}=E,I=n||B;return{width:typeof I=="string"?I:`${I}px`,maxWidth:`calc(100vw - ${d}px - ${mt[.5]})`,height:k?`${k}px`:void 0}},[E,B,n]),j=s.useMemo(()=>{const{wrapper:d,dropdownList:k,helpMessage:I,loaderWrapper:r,noItems:u}=Gt();return{wrapper:d(),dropdownList:k(),helpMessage:I(),loaderWrapper:r(),noItems:u()}},[]),z=Pt(Xt,y);return{renderListBox:s.useCallback(()=>$(o.createElement("div",{className:j.wrapper,style:U},p&&g&&o.createElement(ft,{role:"status"},z.loadingText),o.createElement("div",{id:A,ref:v,role:"listbox","aria-hidden":!p,className:j.dropdownList,style:w},e&&o.createElement("p",{className:j.helpMessage},o.createElement(_t,{color:"TEXT_GREY",text:e,iconGap:.25})),p?g?o.createElement("div",{className:j.loaderWrapper},o.createElement(yt,{"aria-hidden":!0})):t.length===0?o.createElement("p",{role:"alert","aria-live":"polite",className:j.noItems},z.noResultText):N.map(d=>o.createElement(Wt,{key:d.id,option:d,onAdd:X,onSelect:Y,onMouseOver:G,activeRef:d.id===(i==null?void 0:i.id)?R:void 0})):null,q()))),[i==null?void 0:i.id,q,N,t.length,p,g,e,A,z,X,G,Y,j,w,U,$]),activeOption:i,handleKeyDown:W,listBoxId:A,listBoxRef:v}},Qt=(t,e)=>e.some(n=>de(n,t)),Vt=({selected:t,isItemSelected:e=Qt,...n})=>{const a=s.useCallback(h=>e(h,t),[t,e]);return Zt(n,a)};function Zt({items:t,creatable:e,inputValue:n="",isFilteringDisabled:a=!1},h){const p=s.useId(),g=s.useId(),b=s.useMemo(()=>t.map((i,x)=>({id:`${g}-${x}`,selected:h(i),isNew:!1,item:i})),[h,t,g]),y=s.useMemo(()=>e&&n&&t.every(i=>i.label!==n)?{id:p,isNew:!0,selected:!1,item:{label:n,value:n}}:null,[n,t,e,p]),c=s.useMemo(()=>y?[y,...b]:b,[b,y]);return{options:s.useMemo(()=>a||!n?c:c.filter(({item:{label:i}})=>Ie(ae(i)).includes(Ie(n))),[c,n,a])}}const es=({needsTooltip:t,text:e,children:n})=>t?o.createElement(bt,{message:e,multiLine:!0},n):o.createElement(o.Fragment,null,n),Be="削除",ts=J({slots:{wrapper:"smarthr-ui-MultiComboBox-selectedItem shr-flex shr-items-center shr-gap-0.75 shr-leading-normal [&]:shr-rounded-em",itemLabel:"smarthr-ui-MultiComboBox-selectedItemLabel",deleteButton:["smarthr-ui-MultiComboBox-deleteButton","shr-group/deleteButton","shr-shrink shr-rounded-full shr-leading-[0] shr-text-black","focus-visible:shr-shadow-[unset]"],deleteButtonIcon:"group-focus-visible/deleteButton:shr-focus-indicator group-focus-visible/deleteButton:shr-rounded-full"},variants:{enableEllipsis:{true:{itemLabel:"shr-overflow-hidden shr-overflow-ellipsis shr-whitespace-nowrap"}},disabled:{true:{deleteButton:"shr-cursor-not-allowed"},false:{}}}});function ss({item:t,disabled:e,onDelete:n,enableEllipsis:a,buttonRef:h,decorators:p}){var P;const g=s.useRef(null),[b,y]=s.useState(!1),{deletable:c=!0}=t,_=s.useCallback(()=>{n&&n(t)},[t,n]);s.useEffect(()=>{const C=g.current;!C||!a||C.offsetWidth<C.scrollWidth&&y(!0)},[a]);const{wrapper:i,itemLabel:x,deleteButton:F,deleteButtonIcon:L}=ts(),{wrapperStyle:v,itemLabelStyle:E,deleteButtonStyle:T,deleteButtonIconStyle:B}=s.useMemo(()=>({wrapperStyle:i(),itemLabelStyle:x({enableEllipsis:a}),deleteButtonStyle:F({disabled:e}),deleteButtonIconStyle:L()}),[F,L,e,a,x,i]);return o.createElement(es,{needsTooltip:b,text:t.label},o.createElement(Nt,{disabled:e,className:v},o.createElement("span",{className:E,ref:g},t.label),c&&o.createElement(Tt,{className:T,disabled:e,onClick:_,onKeyDown:C=>{(C.key==="Enter"||C.key==="Backspace"||C.key===" ")&&(C.stopPropagation(),_())},ref:h,tabIndex:-1},o.createElement(kt,{color:e?"TEXT_DISABLED":"inherit",alt:((P=p==null?void 0:p.destroyButtonIconAlt)==null?void 0:P.call(p,Be))||Be,className:B}))))}function Pe(t,e){return t?t.classList.contains(e)||Pe(t.parentElement,e):!1}const Ne="選択済みアイテム",rs=J({slots:{wrapper:["smarthr-ui-MultiComboBox","shr-box-border shr-inline-flex shr-min-w-[15em] shr-rounded-m shr-border shr-border-solid shr-px-0.5 shr-py-0.25 shr-align-bottom","contrast-more:shr-border-high-contrast","has-[[aria-invalid]]:shr-border-danger"],inputArea:"shr-flex shr-flex-1 shr-flex-wrap shr-gap-0.5 shr-overflow-y-auto",selectedList:"smarthr-ui-MultiComboBox-selectedList shr-contents shr-list-none [&_li]:shr-min-w-0",inputWrapper:"shr-flex shr-flex-1 shr-items-center",input:["smarthr-ui-MultiComboBox-input","shr-w-full shr-min-w-[5em] shr-border-none shr-text-base shr-text-black shr-outline-none shr-outline-0","disabled:shr-hidden"],placeholderEl:"smarthr-ui-MultiComboBox-placeholder shr-my-0 shr-self-center",suffixWrapper:["shr-relative -shr-me-0.5 shr-ms-0.5 shr-p-0.5",'before:shr-absolute before:shr-inset-x-0 before:shr-inset-y-0.25 before:shr-w-0 before:shr-border-0 before:shr-border-l before:shr-border-solid before:shr-border-default before:shr-content-[""]'],suffixIcon:"shr-block"},variants:{focused:{true:{wrapper:"shr-focus-indicator"}},disabled:{true:{wrapper:"shr-cursor-not-allowed shr-border-default/50 shr-bg-white-darken shr-text-disabled"},false:{wrapper:"shr-cursor-text shr-bg-white"}},hidden:{true:{inputWrapper:"shr-pointer-events-none shr-absolute shr-opacity-0"}}},compoundVariants:[{disabled:!1,className:{wrapper:"shr-border-default"}}]}),ns=({items:t,selectedItems:e,name:n,disabled:a=!1,required:h=!1,error:p=!1,creatable:g=!1,placeholder:b="",autoComplete:y,dropdownHelpMessage:c,isLoading:_,selectedItemEllipsis:i,width:x,dropdownWidth:F="auto",inputValue:L,className:v,onChange:E,onChangeInput:T,onAdd:B,onDelete:P,onSelect:C,onChangeSelected:R,onFocus:W,onBlur:$,onKeyPress:A,decorators:N,isItemSelected:q,style:X,...Y},G)=>{var ke;const U=s.useRef(null),[w,j]=s.useState(!1),[z,se]=s.useState(!1),d=s.useMemo(()=>L!==void 0,[L]),[k,I]=s.useState(""),r=d?L:k,[u,m]=s.useState(!1),{options:M}=Vt({items:t,selected:e,creatable:g,inputValue:r,isItemSelected:q}),O=s.useCallback(l=>{d||I(l)},[d]),D=s.useCallback(l=>{requestAnimationFrame(()=>{P&&P(l),R&&R(e.filter(H=>!de(H,l)))})},[R,P,e]),S=s.useCallback(l=>{requestAnimationFrame(()=>{const H=e.find(ie=>de(ie,l));H!==void 0?H.deletable!==!1&&D(l):(C&&C(l),R&&R(e.concat(l)))})},[D,R,C,e]),{renderListBox:Q,activeOption:V,handleKeyDown:Z,listBoxId:Re,listBoxRef:Ae}=Jt({options:M,dropdownHelpMessage:c,dropdownWidth:F,onAdd:B,onSelect:S,isExpanded:w,isLoading:_,triggerRef:U,decorators:N}),{deletionButtonRefs:je,inputRef:K,focusPrevDeletionButton:pe,focusNextDeletionButton:me,resetDeletionButtonFocus:ee}=jt(e.length);s.useImperativeHandle(G,()=>K.current);const oe=s.useCallback(()=>{W&&W(),j(!0)},[W]),le=s.useCallback(()=>{w&&($&&$(),j(!1),ee())},[w,$,ee]),Oe=s.useMemo(()=>w?he.black:a?he.disabled:he.grey,[a,w]);Rt([U,Ae],le),s.useEffect(()=>{var l;z?(se(!1),(l=K.current)==null||l.select()):O("")},[e,K,O]),s.useEffect(()=>{w&&K.current&&K.current.focus()},[K,w,O,e]);const Fe=s.useCallback(l=>{var H,ie;if(!u){if(l.key==="Escape"||l.key==="Esc")l.stopPropagation(),le();else if(l.key==="Tab")w&&((H=K.current)==null||H.focus()),le();else if(l.key==="Left"||l.key==="ArrowLeft")l.stopPropagation(),pe();else if(l.key==="Right"||l.key==="ArrowRight")l.stopPropagation(),me();else if(l.key==="Backspace"&&!r&&e.length>0&&e[e.length-1].deletable!==!1){l.preventDefault(),l.stopPropagation();const Ee=e[e.length-1];D(Ee),se(!0),O(ae(Ee.label))}else l.stopPropagation(),(ie=K.current)==null||ie.focus(),ee();Z(l)}},[le,me,pe,Z,K,u,w,ee,D,r,e,O]),We=s.useCallback(l=>{!Pe(l.target,"smarthr-ui-MultiComboBox-deleteButton")&&!a&&!w&&oe()},[w,a,oe]),$e=s.useCallback(l=>{E&&E(l),T&&T(l),O(l.currentTarget.value)},[E,T,O]),Ue=s.useCallback(()=>{ee(),w||oe()},[w,oe,ee]),De=s.useCallback(()=>m(!0),[]),Ke=s.useCallback(()=>m(!1),[]),ze=s.useCallback(l=>{(l.key==="Down"||l.key==="ArrowDown"||l.key==="Up"||l.key==="ArrowUp")&&l.preventDefault()},[]),He=s.useCallback(l=>{l.key==="Enter"&&l.preventDefault(),A&&A(l)},[A]),fe=s.useId(),{wrapper:be,inputArea:xe,selectedList:ge,inputWrapper:ye,input:ve,placeholderEl:we,suffixWrapper:_e,suffixIcon:Ce}=rs(),{wrapperStyleProps:Xe,inputAreaStyle:qe,selectedListStyle:Ye,inputWrapperStyle:Ge,inputStyle:Je,placeholderStyle:Qe,suffixWrapperStyle:Ve,suffixIconStyle:Ze}=s.useMemo(()=>{const l=typeof x=="number"?`${x}px`:x;return{wrapperStyleProps:{style:{...X,width:l},className:be({focused:w,disabled:a,className:v})},inputAreaStyle:xe(),selectedListStyle:ge(),inputWrapperStyle:ye({hidden:!w}),inputStyle:ve(),placeholderStyle:we(),suffixWrapperStyle:_e({disabled:a}),suffixIconStyle:Ce()}},[v,a,ve,xe,ye,w,we,ge,X,Ce,_e,x,be]);return o.createElement("div",{...Xe,ref:U,onClick:We,onKeyDown:Fe,onKeyPress:He,role:"group"},o.createElement("div",{className:qe},o.createElement("ul",{id:fe,"aria-label":((ke=N==null?void 0:N.selectedListAriaLabel)==null?void 0:ke.call(N,Ne))||Ne,className:Ye},e.map((l,H)=>o.createElement("li",{key:`${l.label}-${ae(l.value)}`},o.createElement(ss,{item:l,disabled:a,onDelete:D,enableEllipsis:i,buttonRef:je[H],decorators:N})))),o.createElement("div",{className:Ge},o.createElement("input",{...Y,"data-smarthr-ui-input":"true",type:"text",name:n,value:r,disabled:a,required:h&&e.length===0,ref:K,onChange:$e,onFocus:Ue,onCompositionStart:De,onCompositionEnd:Ke,onKeyDown:ze,autoComplete:y??"off",tabIndex:0,role:"combobox","aria-activedescendant":V==null?void 0:V.id,"aria-controls":`${Re} ${fe}`,"aria-haspopup":"listbox","aria-expanded":w,"aria-invalid":p||void 0,"aria-disabled":a,"aria-autocomplete":"list",className:Je})),e.length===0&&b&&!w&&o.createElement("p",{className:Qe},b)),o.createElement("div",{className:Ve},o.createElement(xt,{color:Oe,className:Ze})),Q())},Le=lt(ns);function fs({authUser:t,areas:e,subareas:n,areaToSubarea:a,musicCategories:h,musicInstCategories:p,musicInsts:g,musicCategoryToInstCategoryMap:b,instCategoryToInstruments:y,formData:c={}}){const _=rt(),{data:i,setData:x,post:F,processing:L,errors:v}=et({name:c.name??"",furigana:c.furigana??"",email:c.email??"",password:c.password??"",area_ids:c.area_ids??[],subarea_ids:c.subarea_ids??[],music_category_ids:c.music_category_ids??[],newsletter_opt_in:Number(c.newsletter_opt_in)??0,email_notify_opt_in:Number(c.email_notify_opt_in)??0,music_inst_category_ids:c.music_inst_category_ids??[],music_inst_ids:c.music_inst_ids??[]}),E=e,T=n,B=h,P=p,C=g,R="/otosukui",[W,$]=s.useState([]),[A,N]=s.useState([]),[q,X]=s.useState([]),[Y,G]=s.useState([]),[U,w]=s.useState([]);s.useEffect(()=>{var u,m,M,O,D;const r=(S=[],Q=[])=>{const V=S.map(Z=>Number(Z));return Q.filter(Z=>V.includes(Number(Z.value)))};if(((u=c.area_ids)==null?void 0:u.length)>0){const S=r(c.area_ids,E);$(S)}if(((m=c.subarea_ids)==null?void 0:m.length)>0){const S=r(c.subarea_ids,T);G(S)}if(((M=c.music_category_ids)==null?void 0:M.length)>0){const S=r(c.music_category_ids,B);w(S)}if(((O=c.music_inst_category_ids)==null?void 0:O.length)>0){const S=r(c.music_inst_category_ids,P);N(S)}if(((D=c.music_inst_ids)==null?void 0:D.length)>0){const S=r(c.music_inst_ids,C);X(S)}},[c,E,T,B,P,C]);const j=(r,u,m)=>m.filter(M=>r.some(O=>{const D=String(O.value),S=Number(M.value),Q=u[D];return Array.isArray(Q)?Q.includes(S):!1})),z=(r,u)=>r.some(M=>M.value===u.value)?r.filter(M=>M.value!==u.value):[...r,u],se=P.filter(r=>U.some(u=>{var m;return(m=b[u.value])==null?void 0:m.includes(r.value)})),d=j(W,a,T),k=j(A,y,C),I=r=>{F(route("user.register.confirm"),{preserveState:!0,preserveScroll:!0,onError:u=>{},onSuccess:()=>{}})};return f.jsxs(nt,{theme:_,children:[f.jsx(tt,{title:"音すくい | 新規登録"}),f.jsx(st,{authUser:t}),f.jsxs("main",{className:"pt-[132px] text-[var(--color-text-primary)]  bg-[var(--color-background)] select-none",children:[f.jsx("h2",{className:"font-bold text-3xl text-center",children:"ユーザー登録"}),f.jsx("form",{onSubmit:I,children:f.jsxs(Me,{className:"w-[90vw] md:w-[80vw] lg:w-[60vw] mt-8 mx-auto gap-y-2",children:[f.jsx(re,{autoBindErrorInput:!0,title:"氏名",htmlFor:"name",helpMessage:"スペースなしで入力してください",exampleMessage:"山田太郎",errorMessages:v.name?[v.name]:[],supplementaryMessage:"",statusLabelProps:{children:"必須",type:"red"},children:f.jsx(ce,{id:"name",name:"name",value:i.name,autoComplete:"name",autoFocus:!0,type:"text",required:!0,onChange:r=>x("name",r.target.value),className:"h-[32px]"})}),f.jsx(re,{autoBindErrorInput:!0,title:"フリガナ",htmlFor:"furigana",helpMessage:"カタカナ（スペースなし）で入力してください。",exampleMessage:"ヤマダタロウ",errorMessages:v.furigana?[v.furigana]:[],supplementaryMessage:"",statusLabelProps:{children:"必須",type:"red"},children:f.jsx(ce,{id:"furigana",name:"furigana",value:i.furigana,type:"text",required:!0,onChange:r=>x("furigana",r.target.value),className:"h-[32px]"})}),f.jsx(re,{autoBindErrorInput:!0,title:"メールアドレス",htmlFor:"email",helpMessage:"",exampleMessage:"",errorMessages:v.email?[v.email]:[],supplementaryMessage:"",statusLabelProps:{children:"必須",type:"red"},children:f.jsx(ce,{id:"email",name:"email",value:i.email,autoComplete:"email",type:"email",required:!0,onChange:r=>x("email",r.target.value),className:"h-[32px] w-1/2"})}),f.jsx(re,{autoBindErrorInput:!0,title:"パスワード",htmlFor:"password",helpMessage:"8文字以上で入力してください。",exampleMessage:"",errorMessages:v.password?[v.password]:[],supplementaryMessage:"",statusLabelProps:{children:"必須",type:"red"},children:f.jsx(ce,{id:"password",name:"password",value:i.password,autoComplete:"new-password",type:"password",required:!0,onChange:r=>x("password",r.target.value),className:"h-[32px] w-1/2"})}),f.jsx(re,{title:"都道府県",htmlFor:"area",helpMessage:"地域に合わせた情報をお届けしやすくするために必要です。(複数選択可)",exampleMessage:"",supplementaryMessage:"この項目を選択すると、地域区分の選択肢が表示されます。",statusLabelProps:{children:"任意",type:"grey"},children:f.jsx(Le,{items:E,name:"area",selectedItems:W,onSelect:r=>{if(!(r!=null&&r.value))return;const u=[...W,r];$(u),x("area_ids",u.map(m=>m.value))},onDelete:r=>{if(!(r!=null&&r.value))return;const u=W.filter(m=>m.value!==r.value);$(u),x("area_ids",u.map(m=>m.value))}})}),f.jsx(te,{title:"地域区分",exampleMessage:"",helpMessage:"地域に合わせた、より詳細な情報をお届けしやすくするために必要です。(複数選択可)",supplementaryMessage:"都道府県の項目を選択すると、選択肢が表示されます。",statusLabelProps:{children:"任意",type:"grey"},children:f.jsx(ue,{gap:{column:1.25,row:.5},children:d.map(r=>f.jsx(ne,{id:`subarea_${r.value}`,name:`subarea_${r.value}`,checked:Y.some(u=>u.value===r.value),onChange:()=>{const u=z(Y,r);G(u),x("subarea_ids",u.map(m=>m.value))},children:r.label},r.value))})}),f.jsx(te,{exampleMessage:"",helpMessage:"検索・メルマガ配信のために利用します。(複数選択可)",supplementaryMessage:"この項目を選択すると、楽器カテゴリの項目が表示されます。",title:"経験・興味のある音楽ジャンル",statusLabelProps:{children:"任意",type:"grey"},children:f.jsx(ue,{gap:{column:1.25,row:.5},children:B.map(r=>f.jsx(ne,{id:`music_category_${r.value}`,name:`music_category_${r.value}`,checked:U.some(u=>u.value===r.value),onChange:()=>{const u={label:r.label,value:r.value},m=z(U,u);w(m),x("music_category_ids",m.map(M=>M.value))},children:r.label},r.value))})}),f.jsx(te,{exampleMessage:"",helpMessage:"地域に基づいた情報を配信します。",supplementaryMessage:"",title:"メールマガジン",statusLabelProps:{children:"任意",type:"grey"},children:f.jsx(ne,{id:"newsletter_opt_in",name:"newsletter_opt_in",checked:i.newsletter_opt_in===1,onChange:r=>x("newsletter_opt_in",r.target.checked?1:0),children:"受け取る"})}),f.jsx(te,{exampleMessage:"",helpMessage:"お気に入りしたサイトの情報をメールで希望日時に通知する機能です。",supplementaryMessage:"",title:"メール通知機能",statusLabelProps:{children:"任意",type:"grey"},children:f.jsx(ne,{id:"email_notify_opt_in",name:"email_notify_opt_in",checked:i.email_notify_opt_in===1,onChange:r=>x("email_notify_opt_in",r.target.checked?1:0),children:"利用する"})}),f.jsx(te,{exampleMessage:"",helpMessage:"楽器の分類を選択してください。(複数選択可)",supplementaryMessage:"音楽ジャンルを選択すると、選択肢が表示されます。",title:"経験・興味のある楽器カテゴリ",statusLabelProps:{children:"任意",type:"grey"},className:"block",children:f.jsx(Me,{children:f.jsx(Le,{items:se,name:"music_inst_category",selectedItems:A,onSelect:r=>{if(!(r!=null&&r.value))return;const u=[...A,r];N(u),x("music_inst_category_ids",u.map(m=>m.value))},onDelete:r=>{if(!(r!=null&&r.value))return;const u=A.filter(m=>m.value!==r.value);N(u),x("music_inst_category_ids",u.map(m=>m.value))}})})}),f.jsx(te,{exampleMessage:"",helpMessage:"楽器名を選択してください。(複数選択可)",supplementaryMessage:"楽器カテゴリを選択すると、選択肢が表示されます。",title:"経験・興味のある楽器名",statusLabelProps:{children:"任意",type:"grey"},className:"block",children:f.jsx(ue,{gap:{column:1.25,row:.5},children:k.map(r=>f.jsx(ne,{id:`inst_${r.value}`,name:`inst_${r.value}`,checked:q.some(u=>u.value===r.value),onChange:()=>{const u=z(q,r);X(u),x("music_inst_ids",u.map(m=>m.value))},children:r.label},r.value))})})]})}),f.jsxs("div",{className:"flex flex-col mx-auto mt-16 md:flex-row w-[160px] md:w-[368px] gap-y-6 md:gap-x-12 pb-16",children:[f.jsx(wt,{href:R,prefix:"",size:"default",suffix:"",variant:"secondary",wide:!0,className:"h-[44px] bg-[var(--color-white)] font-bold text-base/[1] border-[var(--color-text-primary)] hover:bg-[var(--color-primary-bg-hover)] hover:text-[var(--color-primary)] hover:border-[var(--color-primary)]",children:"キャンセル"}),f.jsx(vt,{type:"button",onClick:I,prefix:"",size:"default",suffix:"",variant:"primary",wide:!0,disabled:L,className:"h-[44px] bg-[var(--color-primary)] font-bold text-base/[1] border-[var(--color-primary)] text-[var(--color-white)] hover:bg-[var(--color-primary-hover)] hover:border-[var(--color-primary-hover)]",children:"確認"})]})]})]})}export{fs as default};
